@*
    Layout for User Panel.
    - Profile
    - Database
    - Tools
    - Help
    - About Goliath
    - Build Info
*@
@using Goliath.Models
@inject Goliath.Repository.IAccountRepository _accountRepository;
@inject Microsoft.AspNetCore.Identity.SignInManager<ApplicationUser> _signInManager;
@{
    Layout = "_Layout";
}

@section UniqueHeader {
    <link href="~/css/UserPanel/UserPanelStyle.css" rel="stylesheet" />
    <script src="~/js/UserPanel/UserPanelScript.js"></script>
}

<main>
    <!-- Navbar Start -->
    <header>
        <nav class="navbar navbar-expand-lg navbar-dark bg-primary ht-tm-element">
            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo03" aria-controls="navbarTogglerDemo03" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <!-- Navbar Icon Start -->
            <a class="navbar-brand" href="#!">
                <img src="@ViewData["WebIcon"]" height="40" width="40" />
                Goliath
            </a>
            <!-- Navbar Icon End -->
            <div class="collapse navbar-collapse" id="navbarTogglerDemo03">
                <ul class="navbar-nav mr-auto mt-2 mt-md-0">
                    <li class="nav-item" id="profile-nav">
                        <a class="nav-link" asp-controller="UserPanel" asp-action="Index">Profile</a>
                    </li>
                    <li class="nav-item" id="database-nav">
                        <a class="nav-link" asp-controller="UserPanel" asp-action="Database">Database</a>
                    </li>
                    <li class="nav-item" id="utilities-nav">
                        <a class="nav-link" asp-controller="UserPanel" asp-action="Utilities">Utilities</a>
                    </li>
                    <li class="nav-item" id="help-nav">
                        <a class="nav-link" asp-controller="UserPanel" asp-action="Help">Help (Q&A)</a>
                    </li>
                    <li class="nav-item" id="about-nav">
                        <a class="nav-link" asp-controller="UserPanel" asp-action="About">About Goliath</a>
                    </li>
                    <li class="nav-item" id="build-nav">
                        <a class="nav-link" asp-controller="UserPanel" asp-action="BuildInfo">Build Info</a>
                    </li>
                    @*If the user is signed in and is an admin then load admin tab.*@
                    @if (_signInManager.IsSignedIn(User) && await _accountRepository.IsAdmin(User.Identity.Name))
                    {
                        <li class="nav-item" id="admin-nav">
                            <a class="nav-link" asp-controller="AdminPanel" asp-action="Index">Admin Panel</a>
                        </li>
                    }

                    @*Dropdown Menu. These do not contain individual pages (Use redirections).*@
                    <li class="nav-item dropdown" id="other-nav">
                        <a class="nav-link dropdown-toggle" href="#" role="button" id="navbarDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Other
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="https://github.com/jluvisi2021/Goliath">Go to GitHub</a>
                            <a class="dropdown-item" href="https://github.com/jluvisi2021/Goliath/wiki">Go to Wiki</a>
                            <a class="dropdown-item" href="#">Suggest Feature</a>
                            <a class="dropdown-item" href="https://github.com/jluvisi2021/Goliath/issues/new">Report Issue</a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item" href="#">Share</a>
                        </div>
                    </li>
                </ul>
                @*Load the top right header indicating the user is logged in.*@
                <partial name="~/Views/UserPanel/_LoginInfo.cshtml" />
            </div>
        </nav>
    </header>
    <!-- Navbar End -->
    <section class="text-center">
        <!-- UserPanel Body Start -->
        @RenderBody()
        <!-- UserPanel Body End -->
    </section>
</main>

@section Scripts {
    <script type="text/javascript" defer>
        $(document).ready(() => {
            @*Highlight the different nav items depending on what page the user is viewing.*@
    updateNav("@ViewData["Title"].ToString().ToLower().Split(" ")[0]");
        });
    </script>
}